openapi: 3.0.3
info:
  title: Discord-like Chat Server API
  description: |
    A Discord-inspired chat server REST API built with Rust (Axum).

    ## Authentication
    Most endpoints require authentication via Bearer JWT token in the Authorization header.

    ## Snowflake IDs
    All entity IDs use Twitter Snowflake format (64-bit integers) represented as strings in JSON
    to avoid JavaScript precision loss.

    ## Pagination
    List endpoints use cursor-based pagination with `before` and `after` parameters
    using Snowflake IDs. Default page size is 50, maximum is 100.

    ## Rate Limiting
    All endpoints include rate limit headers:
    - `X-RateLimit-Limit`: Request quota per window
    - `X-RateLimit-Remaining`: Remaining requests in current window
    - `X-RateLimit-Reset`: Unix timestamp when the window resets
    - `X-RateLimit-Bucket`: Rate limit bucket identifier

    When rate limited, a 429 response includes `Retry-After` header.

    ## Timestamps
    All timestamps use ISO 8601 format (e.g., `2024-01-15T10:30:00.000Z`).

  version: 1.0.0
  contact:
    name: API Support
  license:
    name: MIT

servers:
  - url: http://localhost:8080/api/v1
    description: Local development server
  - url: https://api.example.com/api/v1
    description: Production server

tags:
  - name: Health
    description: Health check endpoints
  - name: Auth
    description: Authentication and authorization
  - name: Users
    description: User management
  - name: Guilds
    description: Guild (server) management
  - name: Channels
    description: Channel management
  - name: Messages
    description: Message operations
  - name: Members
    description: Guild member management
  - name: Roles
    description: Role management
  - name: Reactions
    description: Message reactions
  - name: Invites
    description: Guild invite management
  - name: DMs
    description: Direct message channels

paths:
  # ============================================================================
  # Health Endpoints
  # ============================================================================
  /health:
    get:
      tags:
        - Health
      summary: Basic health check
      description: Returns server health status. Used for basic liveness probes.
      operationId: healthCheck
      security: []
      responses:
        '200':
          description: Server is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
              example:
                status: healthy
                timestamp: "2024-01-15T10:30:00.000Z"

  /health/ready:
    get:
      tags:
        - Health
      summary: Readiness check
      description: |
        Returns detailed readiness status including database and Redis connectivity.
        Used for Kubernetes readiness probes.
      operationId: readinessCheck
      security: []
      responses:
        '200':
          description: Server is ready to accept traffic
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReadinessResponse'
              example:
                status: ready
                timestamp: "2024-01-15T10:30:00.000Z"
                checks:
                  database: healthy
                  redis: healthy
        '503':
          description: Server is not ready
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReadinessResponse'
              example:
                status: not_ready
                timestamp: "2024-01-15T10:30:00.000Z"
                checks:
                  database: healthy
                  redis: unhealthy

  # ============================================================================
  # Authentication Endpoints
  # ============================================================================
  /auth/register:
    post:
      tags:
        - Auth
      summary: Register a new user
      description: Creates a new user account with username, email, and password.
      operationId: register
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            example:
              username: johndoe
              email: john@example.com
              password: SecureP@ss123
              display_name: John Doe
      responses:
        '201':
          description: User created successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/ValidationError'
        '409':
          description: Username or email already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  code: "USER_ALREADY_EXISTS"
                  message: "A user with this email already exists"
                  request_id: "req_abc123def456"
        '429':
          $ref: '#/components/responses/RateLimited'

  /auth/login:
    post:
      tags:
        - Auth
      summary: Authenticate user
      description: |
        Authenticates a user with email and password. Returns access and refresh tokens.
        The access token expires in 15 minutes. Use the refresh token to obtain new access tokens.
      operationId: login
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            example:
              email: john@example.com
              password: SecureP@ss123
      responses:
        '200':
          description: Authentication successful
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  code: "INVALID_CREDENTIALS"
                  message: "Invalid email or password"
                  request_id: "req_abc123def456"
        '429':
          $ref: '#/components/responses/RateLimited'

  /auth/refresh:
    post:
      tags:
        - Auth
      summary: Refresh access token
      description: |
        Exchanges a valid refresh token for a new access token.
        The refresh token itself is also rotated for security.
      operationId: refreshToken
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
            example:
              refresh_token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '200':
          description: Token refreshed successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Invalid or expired refresh token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  code: "INVALID_REFRESH_TOKEN"
                  message: "The refresh token is invalid or has expired"
                  request_id: "req_abc123def456"
        '429':
          $ref: '#/components/responses/RateLimited'

  /auth/logout:
    post:
      tags:
        - Auth
      summary: Logout user
      description: |
        Invalidates the current refresh token, effectively logging out the user.
        The access token will remain valid until it expires.
      operationId: logout
      security:
        - bearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LogoutRequest'
            example:
              refresh_token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      responses:
        '204':
          description: Logout successful
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # User Endpoints
  # ============================================================================
  /users/@me:
    get:
      tags:
        - Users
      summary: Get current user
      description: Returns the currently authenticated user's profile.
      operationId: getCurrentUser
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Current user profile
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimited'

    patch:
      tags:
        - Users
      summary: Update current user
      description: Updates the currently authenticated user's profile.
      operationId: updateCurrentUser
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
            example:
              display_name: "John D."
              avatar_url: "https://example.com/avatar.png"
              status: "Working on something cool"
      responses:
        '200':
          description: User updated successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimited'

  /users/{user_id}:
    get:
      tags:
        - Users
      summary: Get user by ID
      description: Returns a user's public profile by their ID.
      operationId: getUser
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/UserId'
      responses:
        '200':
          description: User profile
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicUser'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /users/@me/guilds:
    get:
      tags:
        - Users
      summary: Get current user's guilds
      description: Returns a list of guilds the current user is a member of.
      operationId: getCurrentUserGuilds
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Before'
        - $ref: '#/components/parameters/After'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: List of guilds
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # DM Channel Endpoints
  # ============================================================================
  /users/@me/channels:
    get:
      tags:
        - DMs
      summary: Get DM channels
      description: Returns a list of DM channels for the current user.
      operationId: getDMChannels
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of DM channels
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DMChannel'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimited'

    post:
      tags:
        - DMs
      summary: Create DM channel
      description: |
        Creates a new DM channel with the specified recipient.
        If a DM channel already exists with the recipient, returns the existing channel.
      operationId: createDMChannel
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDMRequest'
            example:
              recipient_id: "123456789012345678"
      responses:
        '200':
          description: DM channel (existing or newly created)
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DMChannel'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: Recipient user not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Guild Endpoints
  # ============================================================================
  /guilds:
    post:
      tags:
        - Guilds
      summary: Create guild
      description: Creates a new guild. The authenticated user becomes the owner.
      operationId: createGuild
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGuildRequest'
            example:
              name: "My Awesome Server"
              description: "A place for awesome people"
              icon_url: "https://example.com/icon.png"
      responses:
        '201':
          description: Guild created successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimited'

  /guilds/{guild_id}:
    get:
      tags:
        - Guilds
      summary: Get guild
      description: Returns a guild by ID. User must be a member of the guild.
      operationId: getGuild
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      responses:
        '200':
          description: Guild details
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    patch:
      tags:
        - Guilds
      summary: Update guild
      description: Updates a guild's settings. Requires MANAGE_GUILD permission.
      operationId: updateGuild
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGuildRequest'
            example:
              name: "Updated Server Name"
              description: "New description"
      responses:
        '200':
          description: Guild updated successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Guilds
      summary: Delete guild
      description: Permanently deletes a guild. Only the owner can delete a guild.
      operationId: deleteGuild
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      responses:
        '204':
          description: Guild deleted successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Only the guild owner can delete the guild
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Channel Endpoints
  # ============================================================================
  /guilds/{guild_id}/channels:
    get:
      tags:
        - Channels
      summary: Get guild channels
      description: Returns all channels in a guild. User must be a member of the guild.
      operationId: getGuildChannels
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      responses:
        '200':
          description: List of channels
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Channel'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    post:
      tags:
        - Channels
      summary: Create channel
      description: Creates a new channel in a guild. Requires MANAGE_CHANNELS permission.
      operationId: createGuildChannel
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateChannelRequest'
            example:
              name: "general"
              type: 0
              topic: "General discussion"
              position: 0
      responses:
        '201':
          description: Channel created successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /channels/{channel_id}:
    get:
      tags:
        - Channels
      summary: Get channel
      description: Returns a channel by ID. User must have VIEW_CHANNEL permission.
      operationId: getChannel
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
      responses:
        '200':
          description: Channel details
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    patch:
      tags:
        - Channels
      summary: Update channel
      description: Updates a channel's settings. Requires MANAGE_CHANNELS permission.
      operationId: updateChannel
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateChannelRequest'
            example:
              name: "announcements"
              topic: "Important announcements only"
      responses:
        '200':
          description: Channel updated successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Channel'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Channels
      summary: Delete channel
      description: Deletes a channel. Requires MANAGE_CHANNELS permission.
      operationId: deleteChannel
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
      responses:
        '204':
          description: Channel deleted successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Message Endpoints
  # ============================================================================
  /channels/{channel_id}/messages:
    get:
      tags:
        - Messages
      summary: Get messages
      description: |
        Returns messages from a channel. Requires VIEW_CHANNEL and READ_MESSAGE_HISTORY permissions.
        Messages are returned in descending order (newest first).
      operationId: getMessages
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/Before'
        - $ref: '#/components/parameters/After'
        - name: around
          in: query
          description: Get messages around this message ID
          schema:
            type: string
            example: "123456789012345678"
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: List of messages
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    post:
      tags:
        - Messages
      summary: Create message
      description: |
        Posts a message to a channel. Requires SEND_MESSAGES permission.
        For channels with slow mode, users must wait between messages.
      operationId: createMessage
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMessageRequest'
            example:
              content: "Hello, world!"
              nonce: "unique-client-id-123"
      responses:
        '201':
          description: Message created successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /channels/{channel_id}/messages/{message_id}:
    get:
      tags:
        - Messages
      summary: Get message
      description: Returns a specific message by ID.
      operationId: getMessage
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
      responses:
        '200':
          description: Message details
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    patch:
      tags:
        - Messages
      summary: Edit message
      description: |
        Edits a previously sent message. Users can only edit their own messages.
        The message will show an "edited" indicator after modification.
      operationId: editMessage
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EditMessageRequest'
            example:
              content: "Updated message content"
      responses:
        '200':
          description: Message edited successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Cannot edit another user's message
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Messages
      summary: Delete message
      description: |
        Deletes a message. Users can delete their own messages.
        Users with MANAGE_MESSAGES permission can delete any message.
      operationId: deleteMessage
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
      responses:
        '204':
          description: Message deleted successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Reaction Endpoints
  # ============================================================================
  /channels/{channel_id}/messages/{message_id}/reactions/{emoji}/@me:
    put:
      tags:
        - Reactions
      summary: Add reaction
      description: |
        Adds a reaction to a message. Requires ADD_REACTIONS permission.
        The emoji parameter should be URL-encoded for Unicode emoji (e.g., %F0%9F%91%8D for thumbs up).
      operationId: addReaction
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
        - $ref: '#/components/parameters/Emoji'
      responses:
        '204':
          description: Reaction added successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '400':
          description: Invalid emoji format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Reactions
      summary: Remove own reaction
      description: Removes the current user's reaction from a message.
      operationId: removeOwnReaction
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
        - $ref: '#/components/parameters/Emoji'
      responses:
        '204':
          description: Reaction removed successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /channels/{channel_id}/messages/{message_id}/reactions/{emoji}/{user_id}:
    delete:
      tags:
        - Reactions
      summary: Remove user reaction
      description: |
        Removes another user's reaction from a message.
        Requires MANAGE_MESSAGES permission.
      operationId: removeUserReaction
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
        - $ref: '#/components/parameters/Emoji'
        - $ref: '#/components/parameters/UserId'
      responses:
        '204':
          description: Reaction removed successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /channels/{channel_id}/messages/{message_id}/reactions/{emoji}:
    get:
      tags:
        - Reactions
      summary: Get reactions
      description: Returns users who reacted with a specific emoji.
      operationId: getReactions
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
        - $ref: '#/components/parameters/Emoji'
        - $ref: '#/components/parameters/After'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: List of users who reacted
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PublicUser'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Reactions
      summary: Delete all reactions for emoji
      description: |
        Removes all reactions for a specific emoji from a message.
        Requires MANAGE_MESSAGES permission.
      operationId: deleteAllReactionsForEmoji
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
        - $ref: '#/components/parameters/Emoji'
      responses:
        '204':
          description: All reactions removed successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /channels/{channel_id}/messages/{message_id}/reactions:
    delete:
      tags:
        - Reactions
      summary: Delete all reactions
      description: |
        Removes all reactions from a message.
        Requires MANAGE_MESSAGES permission.
      operationId: deleteAllReactions
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
        - $ref: '#/components/parameters/MessageId'
      responses:
        '204':
          description: All reactions removed successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Member Endpoints
  # ============================================================================
  /guilds/{guild_id}/members:
    get:
      tags:
        - Members
      summary: List guild members
      description: Returns a list of guild members. Requires VIEW_CHANNEL permission.
      operationId: listGuildMembers
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
        - $ref: '#/components/parameters/After'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: List of guild members
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemberListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /guilds/{guild_id}/members/{user_id}:
    get:
      tags:
        - Members
      summary: Get guild member
      description: Returns a specific guild member by user ID.
      operationId: getGuildMember
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
        - $ref: '#/components/parameters/UserId'
      responses:
        '200':
          description: Guild member details
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Member'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    patch:
      tags:
        - Members
      summary: Update guild member
      description: |
        Updates a guild member's attributes (nickname, roles).
        Requires appropriate permissions for each modification.
      operationId: updateGuildMember
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
        - $ref: '#/components/parameters/UserId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMemberRequest'
            example:
              nickname: "Cool Nickname"
              roles:
                - "123456789012345678"
                - "234567890123456789"
      responses:
        '200':
          description: Member updated successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Member'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Members
      summary: Remove guild member (kick)
      description: |
        Removes a member from a guild (kick).
        Requires KICK_MEMBERS permission.
      operationId: removeGuildMember
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
        - $ref: '#/components/parameters/UserId'
      responses:
        '204':
          description: Member removed successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /guilds/{guild_id}/members/@me:
    delete:
      tags:
        - Members
      summary: Leave guild
      description: Leaves a guild. The owner cannot leave their own guild.
      operationId: leaveGuild
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      responses:
        '204':
          description: Left guild successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Guild owners cannot leave their own guild
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Role Endpoints
  # ============================================================================
  /guilds/{guild_id}/roles:
    get:
      tags:
        - Roles
      summary: Get guild roles
      description: Returns all roles in a guild.
      operationId: getGuildRoles
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      responses:
        '200':
          description: List of roles
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Role'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    post:
      tags:
        - Roles
      summary: Create role
      description: Creates a new role in a guild. Requires MANAGE_ROLES permission.
      operationId: createRole
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRoleRequest'
            example:
              name: "Moderator"
              color: 3447003
              permissions: "268435456"
              hoist: true
              mentionable: true
      responses:
        '201':
          description: Role created successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /guilds/{guild_id}/roles/{role_id}:
    get:
      tags:
        - Roles
      summary: Get role
      description: Returns a specific role by ID.
      operationId: getRole
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
        - $ref: '#/components/parameters/RoleId'
      responses:
        '200':
          description: Role details
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    patch:
      tags:
        - Roles
      summary: Update role
      description: Updates a role's settings. Requires MANAGE_ROLES permission.
      operationId: updateRole
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
        - $ref: '#/components/parameters/RoleId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRoleRequest'
            example:
              name: "Senior Moderator"
              color: 15844367
      responses:
        '200':
          description: Role updated successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Roles
      summary: Delete role
      description: |
        Deletes a role. Requires MANAGE_ROLES permission.
        The @everyone role cannot be deleted.
      operationId: deleteRole
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
        - $ref: '#/components/parameters/RoleId'
      responses:
        '204':
          description: Role deleted successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Invite Endpoints
  # ============================================================================
  /guilds/{guild_id}/invites:
    get:
      tags:
        - Invites
      summary: Get guild invites
      description: Returns all invites for a guild. Requires MANAGE_GUILD permission.
      operationId: getGuildInvites
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/GuildId'
      responses:
        '200':
          description: List of invites
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Invite'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /channels/{channel_id}/invites:
    get:
      tags:
        - Invites
      summary: Get channel invites
      description: Returns all invites for a channel. Requires MANAGE_CHANNELS permission.
      operationId: getChannelInvites
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
      responses:
        '200':
          description: List of invites
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Invite'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

    post:
      tags:
        - Invites
      summary: Create channel invite
      description: Creates a new invite for a channel. Requires CREATE_INSTANT_INVITE permission.
      operationId: createChannelInvite
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateInviteRequest'
            example:
              max_age: 86400
              max_uses: 10
              temporary: false
      responses:
        '201':
          description: Invite created successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invite'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  /invites/{invite_code}:
    get:
      tags:
        - Invites
      summary: Get invite
      description: Returns an invite by its code. Does not require authentication.
      operationId: getInvite
      security: []
      parameters:
        - $ref: '#/components/parameters/InviteCode'
      responses:
        '200':
          description: Invite details
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invite'
        '404':
          description: Invite not found or expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          $ref: '#/components/responses/RateLimited'

    post:
      tags:
        - Invites
      summary: Accept invite
      description: |
        Accepts an invite and joins the guild.
        Returns the guild that was joined.
      operationId: acceptInvite
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/InviteCode'
      responses:
        '200':
          description: Successfully joined guild
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Banned from guild or invite expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Invite not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          $ref: '#/components/responses/RateLimited'

    delete:
      tags:
        - Invites
      summary: Delete invite
      description: Deletes an invite. Requires MANAGE_CHANNELS permission on the channel.
      operationId: deleteInvite
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/InviteCode'
      responses:
        '204':
          description: Invite deleted successfully
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

  # ============================================================================
  # Typing Indicator Endpoint
  # ============================================================================
  /channels/{channel_id}/typing:
    post:
      tags:
        - Messages
      summary: Trigger typing indicator
      description: |
        Triggers the typing indicator for the current user in a channel.
        The typing indicator lasts for 10 seconds or until a message is sent.
      operationId: triggerTypingIndicator
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/ChannelId'
      responses:
        '204':
          description: Typing indicator triggered
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimited'

components:
  # ============================================================================
  # Security Schemes
  # ============================================================================
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT access token obtained from /auth/login or /auth/refresh.
        Include in the Authorization header as: `Bearer <token>`

  # ============================================================================
  # Parameters
  # ============================================================================
  parameters:
    UserId:
      name: user_id
      in: path
      required: true
      description: The user's Snowflake ID
      schema:
        type: string
        example: "123456789012345678"

    GuildId:
      name: guild_id
      in: path
      required: true
      description: The guild's Snowflake ID
      schema:
        type: string
        example: "123456789012345678"

    ChannelId:
      name: channel_id
      in: path
      required: true
      description: The channel's Snowflake ID
      schema:
        type: string
        example: "123456789012345678"

    MessageId:
      name: message_id
      in: path
      required: true
      description: The message's Snowflake ID
      schema:
        type: string
        example: "123456789012345678"

    RoleId:
      name: role_id
      in: path
      required: true
      description: The role's Snowflake ID
      schema:
        type: string
        example: "123456789012345678"

    InviteCode:
      name: invite_code
      in: path
      required: true
      description: The invite code (e.g., "abc123")
      schema:
        type: string
        example: "abc123"

    Emoji:
      name: emoji
      in: path
      required: true
      description: |
        URL-encoded emoji. For Unicode emoji, use percent-encoding (e.g., %F0%9F%91%8D for thumbs up).
        For custom emoji, use the format name:id (e.g., custom_emoji:123456789012345678).
      schema:
        type: string
        example: "%F0%9F%91%8D"

    Before:
      name: before
      in: query
      description: Get items before this Snowflake ID (for cursor pagination)
      schema:
        type: string
        example: "123456789012345678"

    After:
      name: after
      in: query
      description: Get items after this Snowflake ID (for cursor pagination)
      schema:
        type: string
        example: "123456789012345678"

    Limit:
      name: limit
      in: query
      description: Maximum number of items to return (1-100, default 50)
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 50

  # ============================================================================
  # Headers
  # ============================================================================
  headers:
    X-RateLimit-Limit:
      description: The number of requests that can be made per window
      schema:
        type: integer
        example: 50

    X-RateLimit-Remaining:
      description: The number of remaining requests in the current window
      schema:
        type: integer
        example: 49

    X-RateLimit-Reset:
      description: Unix timestamp (seconds) when the rate limit resets
      schema:
        type: integer
        example: 1705312200

    X-RateLimit-Bucket:
      description: The rate limit bucket identifier
      schema:
        type: string
        example: "abc123"

    Retry-After:
      description: Seconds to wait before retrying (only on 429 responses)
      schema:
        type: integer
        example: 5

  # ============================================================================
  # Responses
  # ============================================================================
  responses:
    Unauthorized:
      description: Authentication required or invalid token
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              code: "UNAUTHORIZED"
              message: "Invalid or expired authentication token"
              request_id: "req_abc123def456"

    Forbidden:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              code: "FORBIDDEN"
              message: "You do not have permission to perform this action"
              request_id: "req_abc123def456"

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              code: "NOT_FOUND"
              message: "The requested resource was not found"
              request_id: "req_abc123def456"

    ValidationError:
      description: Invalid request body or parameters
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              code: "VALIDATION_ERROR"
              message: "Invalid request body"
              details:
                - field: "username"
                  code: "TOO_SHORT"
                  message: "Username must be at least 2 characters"
                - field: "email"
                  code: "INVALID_FORMAT"
                  message: "Must be a valid email address"
              request_id: "req_abc123def456"

    RateLimited:
      description: Too many requests
      headers:
        X-RateLimit-Limit:
          $ref: '#/components/headers/X-RateLimit-Limit'
        X-RateLimit-Remaining:
          schema:
            type: integer
            example: 0
        X-RateLimit-Reset:
          $ref: '#/components/headers/X-RateLimit-Reset'
        Retry-After:
          $ref: '#/components/headers/Retry-After'
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            error:
              code: "RATE_LIMITED"
              message: "You are being rate limited"
              retry_after: 5
              request_id: "req_abc123def456"

  # ============================================================================
  # Schemas
  # ============================================================================
  schemas:
    # --------------------------------------------------------------------------
    # Health Schemas
    # --------------------------------------------------------------------------
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
      properties:
        status:
          type: string
          enum: [healthy, unhealthy]
          description: Server health status
        timestamp:
          type: string
          format: date-time
          description: ISO 8601 timestamp

    ReadinessResponse:
      type: object
      required:
        - status
        - timestamp
        - checks
      properties:
        status:
          type: string
          enum: [ready, not_ready]
          description: Server readiness status
        timestamp:
          type: string
          format: date-time
          description: ISO 8601 timestamp
        checks:
          type: object
          properties:
            database:
              type: string
              enum: [healthy, unhealthy]
            redis:
              type: string
              enum: [healthy, unhealthy]

    # --------------------------------------------------------------------------
    # Error Schemas
    # --------------------------------------------------------------------------
    ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          $ref: '#/components/schemas/Error'

    Error:
      type: object
      required:
        - code
        - message
        - request_id
      properties:
        code:
          type: string
          description: Machine-readable error code
          example: "VALIDATION_ERROR"
        message:
          type: string
          description: Human-readable error message
          example: "Invalid request body"
        details:
          type: array
          description: Additional error details (for validation errors)
          items:
            $ref: '#/components/schemas/ErrorDetail'
        retry_after:
          type: integer
          description: Seconds to wait before retrying (for rate limit errors)
          example: 5
        request_id:
          type: string
          description: Unique request identifier for debugging
          example: "req_abc123def456"

    ErrorDetail:
      type: object
      required:
        - field
        - code
        - message
      properties:
        field:
          type: string
          description: The field that caused the error
          example: "email"
        code:
          type: string
          description: Machine-readable error code for this field
          example: "INVALID_FORMAT"
        message:
          type: string
          description: Human-readable error message
          example: "Must be a valid email address"

    # --------------------------------------------------------------------------
    # Auth Schemas
    # --------------------------------------------------------------------------
    RegisterRequest:
      type: object
      required:
        - username
        - email
        - password
      properties:
        username:
          type: string
          minLength: 2
          maxLength: 32
          pattern: '^[a-zA-Z0-9_]+$'
          description: Unique username (alphanumeric and underscores only)
          example: "johndoe"
        email:
          type: string
          format: email
          maxLength: 254
          description: User's email address
          example: "john@example.com"
        password:
          type: string
          minLength: 8
          maxLength: 128
          description: Password (minimum 8 characters)
          example: "SecureP@ss123"
        display_name:
          type: string
          maxLength: 32
          description: Display name (defaults to username if not provided)
          example: "John Doe"

    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          description: User's email address
          example: "john@example.com"
        password:
          type: string
          description: User's password
          example: "SecureP@ss123"

    RefreshTokenRequest:
      type: object
      required:
        - refresh_token
      properties:
        refresh_token:
          type: string
          description: The refresh token from previous authentication
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

    LogoutRequest:
      type: object
      properties:
        refresh_token:
          type: string
          description: Optional refresh token to invalidate
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

    AuthResponse:
      type: object
      required:
        - access_token
        - refresh_token
        - expires_in
        - token_type
        - user
      properties:
        access_token:
          type: string
          description: JWT access token
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        refresh_token:
          type: string
          description: JWT refresh token
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        expires_in:
          type: integer
          description: Access token expiry in seconds
          example: 900
        token_type:
          type: string
          enum: [Bearer]
          description: Token type (always "Bearer")
          example: "Bearer"
        user:
          $ref: '#/components/schemas/User'

    # --------------------------------------------------------------------------
    # User Schemas
    # --------------------------------------------------------------------------
    User:
      type: object
      required:
        - id
        - username
        - email
        - display_name
        - avatar_url
        - status
        - bot
        - created_at
        - updated_at
      properties:
        id:
          type: string
          description: User's Snowflake ID
          example: "123456789012345678"
        username:
          type: string
          description: Unique username
          example: "johndoe"
        email:
          type: string
          format: email
          description: User's email address
          example: "john@example.com"
        display_name:
          type: string
          description: Display name
          example: "John Doe"
        avatar_url:
          type: string
          format: uri
          nullable: true
          description: URL to user's avatar image
          example: "https://cdn.example.com/avatars/123456789012345678.png"
        status:
          type: string
          nullable: true
          description: Custom status message
          example: "Working on something cool"
        bot:
          type: boolean
          description: Whether this is a bot account
          example: false
        created_at:
          type: string
          format: date-time
          description: When the account was created
          example: "2024-01-15T10:30:00.000Z"
        updated_at:
          type: string
          format: date-time
          description: When the account was last updated
          example: "2024-01-15T10:30:00.000Z"

    PublicUser:
      type: object
      description: Public user profile (excludes sensitive fields like email)
      required:
        - id
        - username
        - display_name
        - avatar_url
        - bot
        - created_at
      properties:
        id:
          type: string
          description: User's Snowflake ID
          example: "123456789012345678"
        username:
          type: string
          description: Unique username
          example: "johndoe"
        display_name:
          type: string
          description: Display name
          example: "John Doe"
        avatar_url:
          type: string
          format: uri
          nullable: true
          description: URL to user's avatar image
          example: "https://cdn.example.com/avatars/123456789012345678.png"
        bot:
          type: boolean
          description: Whether this is a bot account
          example: false
        created_at:
          type: string
          format: date-time
          description: When the account was created
          example: "2024-01-15T10:30:00.000Z"

    UpdateUserRequest:
      type: object
      properties:
        display_name:
          type: string
          maxLength: 32
          description: New display name
          example: "John D."
        avatar_url:
          type: string
          format: uri
          nullable: true
          description: New avatar URL (null to remove)
          example: "https://example.com/avatar.png"
        status:
          type: string
          maxLength: 128
          nullable: true
          description: Custom status message (null to clear)
          example: "Working on something cool"

    # --------------------------------------------------------------------------
    # Guild Schemas
    # --------------------------------------------------------------------------
    Guild:
      type: object
      required:
        - id
        - name
        - description
        - icon_url
        - owner_id
        - member_count
        - created_at
        - updated_at
      properties:
        id:
          type: string
          description: Guild's Snowflake ID
          example: "123456789012345678"
        name:
          type: string
          description: Guild name
          example: "My Awesome Server"
        description:
          type: string
          nullable: true
          description: Guild description
          example: "A place for awesome people"
        icon_url:
          type: string
          format: uri
          nullable: true
          description: URL to guild icon
          example: "https://cdn.example.com/icons/123456789012345678.png"
        owner_id:
          type: string
          description: Owner's user ID
          example: "123456789012345678"
        member_count:
          type: integer
          description: Total number of members
          example: 150
        created_at:
          type: string
          format: date-time
          description: When the guild was created
          example: "2024-01-15T10:30:00.000Z"
        updated_at:
          type: string
          format: date-time
          description: When the guild was last updated
          example: "2024-01-15T10:30:00.000Z"

    GuildListResponse:
      type: object
      required:
        - data
        - pagination
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Guild'
        pagination:
          $ref: '#/components/schemas/Pagination'

    CreateGuildRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
          description: Guild name
          example: "My Awesome Server"
        description:
          type: string
          maxLength: 1000
          description: Guild description
          example: "A place for awesome people"
        icon_url:
          type: string
          format: uri
          description: Guild icon URL
          example: "https://example.com/icon.png"

    UpdateGuildRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
          description: New guild name
          example: "Updated Server Name"
        description:
          type: string
          maxLength: 1000
          nullable: true
          description: New guild description
          example: "New description"
        icon_url:
          type: string
          format: uri
          nullable: true
          description: New guild icon URL (null to remove)
          example: "https://example.com/new-icon.png"

    # --------------------------------------------------------------------------
    # Channel Schemas
    # --------------------------------------------------------------------------
    Channel:
      type: object
      required:
        - id
        - guild_id
        - type
        - name
        - topic
        - position
        - created_at
        - updated_at
      properties:
        id:
          type: string
          description: Channel's Snowflake ID
          example: "123456789012345678"
        guild_id:
          type: string
          nullable: true
          description: Parent guild ID (null for DM channels)
          example: "123456789012345678"
        type:
          type: integer
          description: |
            Channel type:
            - 0: GUILD_TEXT - Text channel in a guild
            - 1: DM - Direct message between users
            - 4: GUILD_CATEGORY - Category for organizing channels
          enum: [0, 1, 4]
          example: 0
        name:
          type: string
          description: Channel name
          example: "general"
        topic:
          type: string
          nullable: true
          description: Channel topic/description
          example: "General discussion"
        position:
          type: integer
          description: Sorting position in the channel list
          example: 0
        parent_id:
          type: string
          nullable: true
          description: Parent category ID (for channels in categories)
          example: "123456789012345678"
        slowmode_seconds:
          type: integer
          description: Slowmode delay in seconds (0 = disabled)
          example: 0
        created_at:
          type: string
          format: date-time
          description: When the channel was created
          example: "2024-01-15T10:30:00.000Z"
        updated_at:
          type: string
          format: date-time
          description: When the channel was last updated
          example: "2024-01-15T10:30:00.000Z"

    DMChannel:
      type: object
      required:
        - id
        - type
        - recipients
        - last_message_id
        - created_at
      properties:
        id:
          type: string
          description: Channel's Snowflake ID
          example: "123456789012345678"
        type:
          type: integer
          description: Channel type (always 1 for DM)
          enum: [1]
          example: 1
        recipients:
          type: array
          description: Users in the DM
          items:
            $ref: '#/components/schemas/PublicUser'
        last_message_id:
          type: string
          nullable: true
          description: ID of the last message
          example: "234567890123456789"
        created_at:
          type: string
          format: date-time
          description: When the DM was created
          example: "2024-01-15T10:30:00.000Z"

    CreateChannelRequest:
      type: object
      required:
        - name
        - type
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[a-z0-9-]+$'
          description: Channel name (lowercase, alphanumeric, hyphens)
          example: "general"
        type:
          type: integer
          description: Channel type (0 = text, 4 = category)
          enum: [0, 4]
          example: 0
        topic:
          type: string
          maxLength: 1024
          description: Channel topic
          example: "General discussion"
        position:
          type: integer
          description: Sorting position
          example: 0
        parent_id:
          type: string
          description: Parent category ID
          example: "123456789012345678"
        slowmode_seconds:
          type: integer
          minimum: 0
          maximum: 21600
          description: Slowmode delay in seconds (max 6 hours)
          example: 0

    UpdateChannelRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[a-z0-9-]+$'
          description: New channel name
          example: "announcements"
        topic:
          type: string
          maxLength: 1024
          nullable: true
          description: New channel topic
          example: "Important announcements only"
        position:
          type: integer
          description: New sorting position
          example: 1
        parent_id:
          type: string
          nullable: true
          description: New parent category ID (null to remove from category)
          example: "123456789012345678"
        slowmode_seconds:
          type: integer
          minimum: 0
          maximum: 21600
          description: Slowmode delay in seconds
          example: 5

    CreateDMRequest:
      type: object
      required:
        - recipient_id
      properties:
        recipient_id:
          type: string
          description: User ID to create DM with
          example: "123456789012345678"

    # --------------------------------------------------------------------------
    # Message Schemas
    # --------------------------------------------------------------------------
    Message:
      type: object
      required:
        - id
        - channel_id
        - author
        - content
        - attachments
        - reactions
        - edited
        - created_at
        - updated_at
      properties:
        id:
          type: string
          description: Message's Snowflake ID
          example: "123456789012345678"
        channel_id:
          type: string
          description: Channel ID where the message was sent
          example: "123456789012345678"
        guild_id:
          type: string
          nullable: true
          description: Guild ID (null for DM messages)
          example: "123456789012345678"
        author:
          $ref: '#/components/schemas/PublicUser'
        content:
          type: string
          description: Message content
          example: "Hello, world!"
        attachments:
          type: array
          description: Attached files
          items:
            $ref: '#/components/schemas/Attachment'
        reactions:
          type: array
          description: Reactions on this message
          items:
            $ref: '#/components/schemas/Reaction'
        edited:
          type: boolean
          description: Whether the message has been edited
          example: false
        nonce:
          type: string
          nullable: true
          description: Client-provided nonce for deduplication
          example: "unique-client-id-123"
        created_at:
          type: string
          format: date-time
          description: When the message was created
          example: "2024-01-15T10:30:00.000Z"
        updated_at:
          type: string
          format: date-time
          description: When the message was last updated
          example: "2024-01-15T10:30:00.000Z"

    MessageListResponse:
      type: object
      required:
        - data
        - pagination
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Message'
        pagination:
          $ref: '#/components/schemas/Pagination'

    CreateMessageRequest:
      type: object
      required:
        - content
      properties:
        content:
          type: string
          minLength: 1
          maxLength: 2000
          description: Message content
          example: "Hello, world!"
        nonce:
          type: string
          maxLength: 25
          description: Client-provided nonce for deduplication
          example: "unique-client-id-123"

    EditMessageRequest:
      type: object
      required:
        - content
      properties:
        content:
          type: string
          minLength: 1
          maxLength: 2000
          description: New message content
          example: "Updated message content"

    Attachment:
      type: object
      required:
        - id
        - filename
        - size
        - url
        - content_type
      properties:
        id:
          type: string
          description: Attachment's Snowflake ID
          example: "123456789012345678"
        filename:
          type: string
          description: Original filename
          example: "image.png"
        size:
          type: integer
          description: File size in bytes
          example: 102400
        url:
          type: string
          format: uri
          description: URL to download the attachment
          example: "https://cdn.example.com/attachments/123/456/image.png"
        content_type:
          type: string
          description: MIME type
          example: "image/png"
        width:
          type: integer
          nullable: true
          description: Image width (for images)
          example: 1920
        height:
          type: integer
          nullable: true
          description: Image height (for images)
          example: 1080

    Reaction:
      type: object
      required:
        - emoji
        - count
        - me
      properties:
        emoji:
          type: string
          description: The emoji used for the reaction
          example: "thumbs_up"
        count:
          type: integer
          description: Number of users who reacted
          example: 5
        me:
          type: boolean
          description: Whether the current user reacted
          example: true

    # --------------------------------------------------------------------------
    # Member Schemas
    # --------------------------------------------------------------------------
    Member:
      type: object
      required:
        - user
        - guild_id
        - roles
        - joined_at
      properties:
        user:
          $ref: '#/components/schemas/PublicUser'
        guild_id:
          type: string
          description: Guild ID
          example: "123456789012345678"
        nickname:
          type: string
          nullable: true
          description: Guild-specific nickname
          example: "Cool Nickname"
        roles:
          type: array
          description: Role IDs assigned to this member
          items:
            type: string
          example: ["123456789012345678", "234567890123456789"]
        joined_at:
          type: string
          format: date-time
          description: When the member joined the guild
          example: "2024-01-15T10:30:00.000Z"

    MemberListResponse:
      type: object
      required:
        - data
        - pagination
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Member'
        pagination:
          $ref: '#/components/schemas/Pagination'

    UpdateMemberRequest:
      type: object
      properties:
        nickname:
          type: string
          maxLength: 32
          nullable: true
          description: New nickname (null to remove)
          example: "Cool Nickname"
        roles:
          type: array
          description: New list of role IDs
          items:
            type: string
          example: ["123456789012345678", "234567890123456789"]

    # --------------------------------------------------------------------------
    # Role Schemas
    # --------------------------------------------------------------------------
    Role:
      type: object
      required:
        - id
        - guild_id
        - name
        - color
        - permissions
        - position
        - hoist
        - mentionable
        - created_at
        - updated_at
      properties:
        id:
          type: string
          description: Role's Snowflake ID
          example: "123456789012345678"
        guild_id:
          type: string
          description: Guild ID
          example: "123456789012345678"
        name:
          type: string
          description: Role name
          example: "Moderator"
        color:
          type: integer
          description: RGB color value as integer
          example: 3447003
        permissions:
          type: string
          description: Permission bit flags as string
          example: "268435456"
        position:
          type: integer
          description: Position in the role hierarchy (higher = more authority)
          example: 1
        hoist:
          type: boolean
          description: Whether to show role members separately in member list
          example: true
        mentionable:
          type: boolean
          description: Whether the role can be mentioned
          example: true
        managed:
          type: boolean
          description: Whether the role is managed by an integration
          example: false
        created_at:
          type: string
          format: date-time
          description: When the role was created
          example: "2024-01-15T10:30:00.000Z"
        updated_at:
          type: string
          format: date-time
          description: When the role was last updated
          example: "2024-01-15T10:30:00.000Z"

    CreateRoleRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: Role name
          default: "new role"
          example: "Moderator"
        color:
          type: integer
          minimum: 0
          maximum: 16777215
          description: RGB color value as integer
          default: 0
          example: 3447003
        permissions:
          type: string
          description: Permission bit flags as string
          default: "0"
          example: "268435456"
        hoist:
          type: boolean
          description: Whether to show role members separately
          default: false
          example: true
        mentionable:
          type: boolean
          description: Whether the role can be mentioned
          default: false
          example: true

    UpdateRoleRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: New role name
          example: "Senior Moderator"
        color:
          type: integer
          minimum: 0
          maximum: 16777215
          description: New RGB color value
          example: 15844367
        permissions:
          type: string
          description: New permission bit flags
          example: "536870912"
        position:
          type: integer
          description: New position in hierarchy
          example: 2
        hoist:
          type: boolean
          description: Whether to show role members separately
          example: true
        mentionable:
          type: boolean
          description: Whether the role can be mentioned
          example: true

    # --------------------------------------------------------------------------
    # Invite Schemas
    # --------------------------------------------------------------------------
    Invite:
      type: object
      required:
        - code
        - guild
        - channel
        - inviter
        - uses
        - max_uses
        - max_age
        - temporary
        - created_at
      properties:
        code:
          type: string
          description: Unique invite code
          example: "abc123"
        guild:
          type: object
          description: Partial guild information
          properties:
            id:
              type: string
              example: "123456789012345678"
            name:
              type: string
              example: "My Awesome Server"
            icon_url:
              type: string
              nullable: true
              example: "https://cdn.example.com/icons/123.png"
        channel:
          type: object
          description: Partial channel information
          properties:
            id:
              type: string
              example: "123456789012345678"
            name:
              type: string
              example: "general"
            type:
              type: integer
              example: 0
        inviter:
          $ref: '#/components/schemas/PublicUser'
        uses:
          type: integer
          description: Number of times the invite has been used
          example: 5
        max_uses:
          type: integer
          description: Maximum number of uses (0 = unlimited)
          example: 10
        max_age:
          type: integer
          description: Duration (in seconds) until expiry (0 = never)
          example: 86400
        temporary:
          type: boolean
          description: Whether members using this invite will be kicked after disconnect
          example: false
        created_at:
          type: string
          format: date-time
          description: When the invite was created
          example: "2024-01-15T10:30:00.000Z"
        expires_at:
          type: string
          format: date-time
          nullable: true
          description: When the invite expires (null = never)
          example: "2024-01-16T10:30:00.000Z"

    CreateInviteRequest:
      type: object
      properties:
        max_age:
          type: integer
          minimum: 0
          maximum: 604800
          description: Duration (seconds) until expiry (0 = never, max 7 days)
          default: 86400
          example: 86400
        max_uses:
          type: integer
          minimum: 0
          maximum: 100
          description: Maximum number of uses (0 = unlimited)
          default: 0
          example: 10
        temporary:
          type: boolean
          description: Whether to kick members after disconnect
          default: false
          example: false

    # --------------------------------------------------------------------------
    # Pagination Schema
    # --------------------------------------------------------------------------
    Pagination:
      type: object
      required:
        - has_more
      properties:
        before:
          type: string
          nullable: true
          description: Cursor for getting items before this ID
          example: "123456789012345678"
        after:
          type: string
          nullable: true
          description: Cursor for getting items after this ID
          example: "234567890123456789"
        has_more:
          type: boolean
          description: Whether there are more items available
          example: true
        limit:
          type: integer
          description: Number of items per page
          example: 50

security:
  - bearerAuth: []
